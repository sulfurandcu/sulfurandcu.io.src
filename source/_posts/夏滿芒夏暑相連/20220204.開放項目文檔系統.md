---
title: 開放項目文檔系統
id: open-doc
date: 2022-02-04 00:00:00
updated:
tags:
categories: [個人博客]
---

---

![](cover.png)

---

<!--more-->

> 某事业部〈某科室〉的文档系统

---

?> `#web` http://127.0.0.1:3000

?> `#ssh` localhost@127.0.0.1 📢 Password:password

?> `#svn` http://svn.com/documents

---


## 使用说明

### 第一步：搭建环境

➀ 安装「node.js」（一个基于 Chrome V8 引擎 的 JavaScript 运行时环境）

```
https://nodejs.org/zh-cn/
```

➁ 安装「[docsify](https://docsify.js.org/#/zh-cn/)」（一个使用 JavaScript 编写的文档网站生成器）

```
npm i docsify-cli -g
```

### 第二步：新建项目

本文档系统的框架已经建好并且已经提交至 SVN 服务器中：

```
http://svn.com/documents
```

### 第三步：预览效果

将上述文档框架下载到本地，在其根目录下执行 docsify serve 命令启动一个本地服务器，就可以在本地预览效果。

```
http://localhost:3000
```

### 第四步：步入正轨（编辑文档、本地预览、提交变更）

搭建好开发环境、将〈＃项目文档〉下载到本地且知道怎么预览以后，就可以开始编辑、预览、提交了，跟代码的编辑、调试、提交没什么两样！

文章使用轻量级标记语言 [markdown](https://www.markdownguide.org/basic-syntax/) 编写；图例使用 [draw.io](https://www.diagrams.net/) 绘制。


## 技术细节

这部分内容是文档系统搭建的一些具体细节，在这里记录一下以供后续维护人员参考。需要说明的一点是，当前使用的这台服务器中运行的系统为 Windows 操作系统，因此以下操作均基于该操作系统。

首先简单描述一下这个系统的工作原理：

刚才提到的这台服务器中有一个名为〈＃文档系统〉的文件夹，里面放着本系统的配置文件和各个项目的文档文件。这些内容被一个叫做文档网站生成器的软件动态转换成网页在 3000 端口以 HTTP 的形式对外提供访问。这样我们就可以通过浏览器以输入 IP 地址加端口的形式访问该文档系统。另外这台服务器上还运行着一个周期任务，这个任务每隔 15 分钟（准确地说是在00分、15分、30分、45分的时候）**从公司的代码仓库中**更新一次上述文件夹，这样就实现了文档内容的自动更新。

### 自动更新

在 Windows 系统中，使用系统自带的任务计划程序实现：在〈计算机管理・任务计划程序〉中创建一个周期任务，每隔一段时间执行一次以下脚本。

```
# doc.py

import os

cmd = "svn up \"e:/＃文档系统\" --non-interactive"
os.system(cmd)
```

?> 任务计划程序配置好之后重启电脑不影响其运行

### 手动更新

改动提交之后想立即更新至文档服务器应该怎么做呢？

远程连接到服务器，手动执行一下 doc.py 即可。

### 手动启动 docsify 服务

电脑关机后 docsify 服务也会随之停止，因此每次开机后都要手动启动 docsify 服务。我尝试过启动后自动运行，但是经常会执行失败。


## 常见问题

### 服务器重启后网页无法访问！

检查 docsify 服务是否已经启动。

### 修改提交之后内容没有更新！

首先看周期更新任务是否正常执行。

如果周期更新任务没有问题，那么有可能是管理员同志的公司帐号密码修改过，而文档服务器中 svn 的访问密码没有同步修改导致的。因为系统会强制让职工每隔一段时间修改一次密码。


## 其他信息

### 为什么选择 docsify ？


之前使用过 hexo 和 hugo 生成静态网页，但是他们均需要将 markdown 文件预先编译成 html 文件之后才能访问，在不配置提交触发编译的情况下使用起来很不方便。而 docsify 是动态生成文档网站，不需要一些繁琐的操作，原始文档修改保存之后网页会立即更新，比较好用。

### 文档中使用的字体是什么？

正文中的拉丁字符使用内嵌的 EB Garamond 字体。代码中的拉丁字符使用内嵌的 Iosevka Term Curly Slab 字体。正文中的泛中日韩字符使用以下字体渲染：

```
Source Han Serif SC     思源宋体
Source Han Sans  SC     思源黑体

PingFang SC             苹果平方
Microsoft YaHei         微软雅黑

sans-serif              系统默认
```

汉字字体文件通常较大，所以没有做内嵌处理。追求显示效果的同学可以自行前往下载安装：

- [EB Garamond](https://fonts.google.com/specimen/EB+Garamond)
- [Iosevka](https://typeof.net/Iosevka)
- [Source Han Sans](https://github.com/adobe-fonts)
- [Source Han Serif](https://github.com/adobe-fonts)


### 图片中使用的字体是什么？

这里的图片指的是由 draw.io 导出的图片。图片中使用的是「[更纱黑体](https://github.com/be5invis/Sarasa-Gothic)」中的 Sarasa Term SC 子集。

?> Sarasa Term SC = Source Han Sans SC + Iosevka Term


## 开发人员

[username@email.com](mailto:username@email.com)
